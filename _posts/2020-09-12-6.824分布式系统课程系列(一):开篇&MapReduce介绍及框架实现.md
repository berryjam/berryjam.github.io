---
layout: post
title: 6.824分布式系统课程系列(一):开篇&MapReduce介绍及框架实现
date: 2020-09-12 23:32:00.000000000 +09:00
tags: 分布式系统 MapReduce 6.824
---


# 开篇&MapReduce介绍及框架实现

**Note. 现在分布式已经成为后台开发者的必备技能，而Golang在并发方面引入了协程的方式，相对于其他语言极大地提高了并发处理能力。综合这些因素，麻省理工大学开设了用Golang实现分布式系统的课程，即6.824。在学习这门课程之前，最好对Golang有一定使用，这样在做实验过程中能大大提高效率。而学习这门课程我们将涉及到存储、通信、计算等三方面的应用基础架构，目的是隐藏分布式复杂性的抽象。对于面试、工作都是非常有帮助的，希望接下来的分享能与大家探索分布式系统遇到的难题和乐趣，并一同成长。**

- [1. 6.824课程开篇内容](https://github.com/berryjam/berryjam.github.io/blob/master/_posts/2020-09-12-6.824%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F%E8%AF%BE%E7%A8%8B%E7%B3%BB%E5%88%97(%E4%B8%80):%E5%BC%80%E7%AF%87&MapReduce%E4%BB%8B%E7%BB%8D%E5%8F%8A%E6%A1%86%E6%9E%B6%E5%AE%9E%E7%8E%B0.md#1-6824%E8%AF%BE%E7%A8%8B%E5%BC%80%E7%AF%87%E5%86%85%E5%AE%B9)

- [2. MapReduce介绍回顾](https://github.com/berryjam/berryjam.github.io/blob/master/_posts/2020-09-12-6.824%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F%E8%AF%BE%E7%A8%8B%E7%B3%BB%E5%88%97(%E4%B8%80):%E5%BC%80%E7%AF%87&MapReduce%E4%BB%8B%E7%BB%8D%E5%8F%8A%E6%A1%86%E6%9E%B6%E5%AE%9E%E7%8E%B0.md#2-mapreduce%E4%BB%8B%E7%BB%8D%E5%9B%9E%E9%A1%BE)

- [3. MapReduce课程框架介绍](https://github.com/berryjam/berryjam.github.io/blob/master/_posts/2020-09-12-6.824%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F%E8%AF%BE%E7%A8%8B%E7%B3%BB%E5%88%97(%E4%B8%80):%E5%BC%80%E7%AF%87&MapReduce%E4%BB%8B%E7%BB%8D%E5%8F%8A%E6%A1%86%E6%9E%B6%E5%AE%9E%E7%8E%B0.md#3-mapreduce%E8%AF%BE%E7%A8%8B%E6%A1%86%E6%9E%B6%E4%BB%8B%E7%BB%8D)

- [4. MapReduce框架逐步实现](https://github.com/berryjam/berryjam.github.io/blob/master/_posts/2020-09-12-6.824%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F%E8%AF%BE%E7%A8%8B%E7%B3%BB%E5%88%97(%E4%B8%80):%E5%BC%80%E7%AF%87&MapReduce%E4%BB%8B%E7%BB%8D%E5%8F%8A%E6%A1%86%E6%9E%B6%E5%AE%9E%E7%8E%B0.md#4-mapreduce%E6%A1%86%E6%9E%B6%E9%80%90%E6%AD%A5%E5%AE%9E%E7%8E%B0)

- [5. 参考资料](https://github.com/berryjam/berryjam.github.io/blob/master/_posts/2020-09-12-6.824%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F%E8%AF%BE%E7%A8%8B%E7%B3%BB%E5%88%97(%E4%B8%80):%E5%BC%80%E7%AF%87&MapReduce%E4%BB%8B%E7%BB%8D%E5%8F%8A%E6%A1%86%E6%9E%B6%E5%AE%9E%E7%8E%B0.md#5-%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99)

## 1. 6.824课程开篇内容


## 2. MapReduce介绍回顾


## 3. MapReduce课程框架介绍


## 4. MapReduce框架逐步实现

master代码详见：https://github.com/berryjam/6.824-2020/blob/master/src/mr/master.go

worker代码详见：https://github.com/berryjam/6.824-2020/blob/master/src/mr/worker.go

运行测试脚本，test-mr.sh，如果都通过的话会在最后输出*PASSED ALL TESTS*，整个运行过程输出大致如下：
```
$ sh test-mr.sh
os.Args[2:] [../pg-being_ernest.txt ../pg-dorian_gray.txt ../pg-frankenstein.txt ../pg-grimm.txt ../pg-huckleberry_finn.txt ../pg-metamorphosis.txt ../pg-sherlock_holmes.txt ../pg-tom_sawyer.txt]
filename:../pg-being_ernest.txt
filename:../pg-dorian_gray.txt
filename:../pg-frankenstein.txt
filename:../pg-grimm.txt
filename:../pg-huckleberry_finn.txt
filename:../pg-metamorphosis.txt
filename:../pg-sherlock_holmes.txt
filename:../pg-tom_sawyer.txt
*** Starting wc test.
2020/09/14 15:55:01 rpc.Register: method "Done" has 1 input parameters; needs exactly three
--- wc test: PASS
os.Args[2:] [../pg-being_ernest.txt ../pg-dorian_gray.txt ../pg-frankenstein.txt ../pg-grimm.txt ../pg-huckleberry_finn.txt ../pg-metamorphosis.txt ../pg-sherlock_holmes.txt ../pg-tom_sawyer.txt]
filename:../pg-being_ernest.txt
filename:../pg-dorian_gray.txt
filename:../pg-frankenstein.txt
filename:../pg-grimm.txt
filename:../pg-huckleberry_finn.txt
filename:../pg-metamorphosis.txt
filename:../pg-sherlock_holmes.txt
filename:../pg-tom_sawyer.txt
*** Starting indexer test.
2020/09/14 15:55:14 rpc.Register: method "Done" has 1 input parameters; needs exactly three
--- indexer test: PASS
*** Starting map parallelism test.
2020/09/14 15:55:25 rpc.Register: method "Done" has 1 input parameters; needs exactly three
--- map parallelism test: PASS
*** Starting reduce parallelism test.
2020/09/14 15:55:40 rpc.Register: method "Done" has 1 input parameters; needs exactly three
--- reduce parallelism test: PASS
os.Args[2:] [../pg-being_ernest.txt ../pg-dorian_gray.txt ../pg-frankenstein.txt ../pg-grimm.txt ../pg-huckleberry_finn.txt ../pg-metamorphosis.txt ../pg-sherlock_holmes.txt ../pg-tom_sawyer.txt]
filename:../pg-being_ernest.txt
filename:../pg-dorian_gray.txt
filename:../pg-frankenstein.txt
filename:../pg-grimm.txt
filename:../pg-huckleberry_finn.txt
filename:../pg-metamorphosis.txt
filename:../pg-sherlock_holmes.txt
filename:../pg-tom_sawyer.txt
*** Starting crash test.
2020/09/14 15:55:57 rpc.Register: method "Done" has 1 input parameters; needs exactly three
--- crash test: PASS
*** PASSED ALL TESTS
```

这个实验是单机通过rpc方式来模拟分布式环境，实际跨节点的分布式环境会更复杂。单机环境的输入都来源同一节点上的文件系统，而分布式系统下输入及输出需要依赖分布式文件系统。而且本节实现只是一个比较简单的map reduce实现，比如master对于并发控制粒度比较粗，性能上还有很多优化的空间，不过这个实验本身还是很有趣，会遇到很多实际问题需要我们去解决让我们积累更多经验。生产级的分布式并行计算框架里面会涉及到更多的细节和优化，可谓任重道远。

## 5. 参考资料

